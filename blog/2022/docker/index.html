<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Docker | MAI Minh's Page </title> <meta name="author" content="N. A. Minh MAI"> <meta name="description" content="Computer Science Blog | Nguyen Anh Minh MAI, AI Research Engineer "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://maiminh1996.github.io//blog/2022/docker/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> MAI Minh's Page </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Docker</h1> <p class="post-meta"> Created in November 29, 2022 by MAI Minh </p> <p class="post-tags"> <a href="/blog/2022"> <i class="fa-solid fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/docker"> <i class="fa-solid fa-hashtag fa-sm"></i> docker</a>   <a href="/blog/tag/cuda"> <i class="fa-solid fa-hashtag fa-sm"></i> cuda</a>   <a href="/blog/tag/installing"> <i class="fa-solid fa-hashtag fa-sm"></i> installing</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="why-docker">Why docker?</h3> <p><img src="../img/container_VM.png" alt=""></p> <p>Docker is a useful tool which allows us to run the code in a contained environment that is <strong>isolated</strong> from the rest of the system. This can be particularly useful when working with deep learning frameworks, which can be difficult to install and configure. By using Docker, we can <strong>easily switch</strong> between different versions of a deep learning framework, or between different libraries or packages, or between different OS version, without affecting the rest of the system. Additionally, Docker can be used to <strong>package</strong> up ythe code and dependencies into a single container, which can be easily shared with others or deployed to a cloud environment. In short, Docker is a containerization solution that lets us <strong>“build, run and share applications with containers”</strong>.</p> <ul> <li>Multiple CUDA versions: <a href="https://maiminh1996.github.io/distilled/cuda/installing-cuda.html#multi-cuda-version-on-the-one-machine">virtualenv</a> –&gt; docker containers</li> <li>Different OSs: launch a Docker container with Ubuntu 20.04 while the host machine is running Ubuntu 16.04 and vice versa.</li> <li>Easily deploy the container to cloud providers (such as AWS, Google Cloud, Azure etc.).</li> </ul> <p><img src="../img/docker-overview.png" alt=""></p> <h3 id="quick-example">Quick example</h3> <h4 id="context">Context</h4> <p>We want to run <a href="https://github.com/sshaoshuai/PointRCNN" rel="external nofollow noopener" target="_blank">PointRCNN</a> by using docker. By default, the author proposes this requirement:</p> <ul> <li>Ubuntu 16.04 (gcc 5.4.0)</li> <li>python 3.6+</li> <li>pytorch 1.0</li> </ul> <p>As expected we will build a docker image like mine <a href="https://hub.docker.com/r/mnaminh1996/pointrcnn" rel="external nofollow noopener" target="_blank">mnaminh1996/pointrcnn</a>. From there, we can launch the docker container to run <a href="https://github.com/sshaoshuai/PointRCNN" rel="external nofollow noopener" target="_blank">PointRCNN</a> on. The steps that we need to do are as follows:</p> <p>Host machine (my machine) description:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">cat /etc/os-release</code>: Ubuntu 18.04</li> <li> <code class="language-plaintext highlighter-rouge">nvcc -V</code>: CUDA 11.0 (FYI: nvcc is CUDA compiler driver included in CUDA toolkit)</li> <li> <code class="language-plaintext highlighter-rouge">cd /usr/local/cuda/samples/1_Utilities/deviceQuery &amp;&amp; sudo make &amp;&amp; ./deviceQuery | grep Capability</code>: GeForce RTX 2070 (capability 7.5 - Turing) –&gt; supported by CUDA 10.2 (FYI: we refer the NVIDIA CUDA Toolkit documentation to determine which GPU architectures (compute capacity) are supported by a specific version of CUDA).</li> <li><code class="language-plaintext highlighter-rouge">ubuntu-drivers devices</code></li> <li> <code class="language-plaintext highlighter-rouge">lscpu</code>, <code class="language-plaintext highlighter-rouge">lshw</code>, <code class="language-plaintext highlighter-rouge">lsblk</code> </li> </ul> <h4 id="build-docker-image">Build docker image</h4> <blockquote> <p>Build docker image on host machine</p> </blockquote> <p>We set up for PointRCNN, dataset, etc following <a href="https://github.com/sshaoshuai/PointRCNN.git" rel="external nofollow noopener" target="_blank">https://github.com/sshaoshuai/PointRCNN.git</a>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone <span class="nt">--recursive</span> https://github.com/sshaoshuai/PointRCNN.git
</code></pre></div></div> <p>Download KITTI dataset and put it somewhere like this:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>tree
data
├── KITTI
│   ├── ImageSets
│   ├── object
│   │   ├──training
│   │      ├──calib &amp; velodyne &amp; label_2 &amp; image_2 &amp; <span class="o">(</span>optional: planes<span class="o">)</span>
│   │   ├──testing
│   │      ├──calib &amp; velodyne &amp; image_2
</code></pre></div></div> <p>Download the <a href="https://drive.google.com/file/d/1aapMXBkSn5c5hNTDdRNI74Ptxfny7PuC/view" rel="external nofollow noopener" target="_blank">pretrained weight</a> proposed by PointRCNN author.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>PointRCNN
<span class="nb">echo</span> <span class="s2">"tqdm
fire
scikit-image
numba
easydict
numpy
scipy
scikit-learn
PyYAML==5.1.2
h5py
tensorboardX
torch==1.0.1
setuptools
protobuf"</span> <span class="o">&gt;</span> requirements.txt
</code></pre></div></div> <p>We then create a Dockerfile based on this docker image <a href="https://registry.hub.docker.com/layers/nvidia/cuda/10.2-cudnn8-devel-ubuntu16.04/images/sha256-f32cdb7cfbd4fb047fe6580333ffd20204fdedc28742fa044885651d5af190f6?context=explore" rel="external nofollow noopener" target="_blank">nvidia/cuda:10.2-cudnn8-devel-ubuntu16.04</a>. But first we need to install Docker + NVIDIA Container Toolkit on the host machine, refer <a href="#pre-requirement">Pre-requirement</a>.</p> <div class="language-Dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> nvidia/cuda:10.2-cudnn8-devel-ubuntu16.04</span>

<span class="k">ENV</span><span class="s"> TZ=Europe/Minsk</span>
<span class="k">RUN </span><span class="nb">ln</span> <span class="nt">-snf</span> /usr/share/zoneinfo/<span class="nv">$TZ</span> /etc/localtime <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$TZ</span> <span class="o">&gt;</span> /etc/timezone

<span class="c"># Install basic dependencies</span>
<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get <span class="nb">install</span> <span class="nt">-y</span> <span class="nt">--no-install-recommends</span> <span class="se">\
</span>    apt-utils <span class="se">\
</span>    build-essential <span class="se">\
</span>    cmake <span class="se">\
</span>    git <span class="se">\
</span>    wget <span class="se">\
</span>    libatlas-base-dev <span class="se">\
</span>    libboost-all-dev <span class="se">\
</span>    libgflags-dev <span class="se">\
</span>    libgoogle-glog-dev <span class="se">\
</span>    libhdf5-serial-dev <span class="se">\
</span>    libleveldb-dev <span class="se">\
</span>    liblmdb-dev <span class="se">\
</span>    libopencv-dev <span class="se">\
</span>    libprotobuf-dev <span class="se">\
</span>    libsnappy-dev <span class="se">\
</span>    protobuf-compiler <span class="se">\
</span>    python3-dev <span class="se">\
</span>    python3-pip <span class="se">\
</span>    python3-setuptools <span class="se">\
</span>    python3-tk <span class="se">\
</span>    python3-wheel

<span class="k">RUN </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> <span class="nt">--no-install-recommends</span> <span class="se">\
</span>    libssl-dev libncurses5-dev libsqlite3-dev <span class="se">\
</span>    libreadline-dev libtk8.6 libgdm-dev <span class="se">\
</span>    libdb4o-cil-dev libpcap-dev

<span class="c"># on ubuntu16.04, python3.5 is default</span>
<span class="c"># RUN apt-get update &amp;&amp; \</span>
<span class="c">#     apt-get install -y software-properties-common &amp;&amp; \</span>
<span class="c">#     add-apt-repository ppa:deadsnakes/ppa</span>
<span class="c"># RUN apt-get update &amp;&amp; apt-get install -y python3.6</span>
<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> <span class="se">\
</span>    apt-get <span class="nb">install</span> <span class="nt">-y</span> build-essential <span class="o">&amp;&amp;</span> <span class="se">\
</span>    wget https://www.python.org/ftp/python/3.6.10/Python-3.6.10.tgz <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="nb">tar </span>xzf Python-3.6.10.tgz <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="nb">cd </span>Python-3.6.10 <span class="o">&amp;&amp;</span> <span class="se">\
</span>    ./configure <span class="o">&amp;&amp;</span> <span class="se">\
</span>    make <span class="o">&amp;&amp;</span> <span class="se">\
</span>    make <span class="nb">install</span>

<span class="k">RUN </span><span class="nb">rm</span> /usr/bin/python
<span class="k">RUN </span><span class="nb">ln</span> <span class="nt">-s</span> /usr/local/bin/python3 /usr/bin/python

<span class="k">WORKDIR</span><span class="s"> /home</span>

<span class="c"># Install Python dependencies</span>
<span class="k">COPY</span><span class="s"> requirements.txt .</span>

<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get <span class="nb">install</span> <span class="nt">--reinstall</span> ca-certificates
<span class="k">RUN </span>python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">--upgrade</span> pip setuptools wheel
<span class="k">RUN </span>python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">--no-cache-dir</span> opencv-python
<span class="k">RUN </span>python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
</code></pre></div></div> <p>Build docker image:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build <span class="nt">-t</span> &lt;name-build-image:name-tag&gt; <span class="nb">.</span>
</code></pre></div></div> <p>Check if docker image built successfully:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker images
<span class="c"># REPOSITORY  TAG     IMAGE ID      CREATED       SIZE</span>
<span class="c"># pointrcnn   latest  dde823c6de1d  23 hthes ago  8.21GB</span>
</code></pre></div></div> <p>Run a container on host machine with <code class="language-plaintext highlighter-rouge">--gpus all</code> to enable gpus into container. We can blind-mount datas <code class="language-plaintext highlighter-rouge">-v /path-to-data-in-host/:/path-to-data-in-container/</code> to use in container:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run a docker container in interactive mode based on the docker image above</span>
<span class="c"># and blind-mount code, dataset, weight, etc</span>
docker run <span class="nt">--gpus</span> all <span class="nt">-v</span> /home/maiminh/PointRCNN/:/home/PointRCNN/ <span class="se">\</span>
  <span class="nt">-v</span> /home/maiminh/KITTI_data/:/home/PointRCNN/data/ <span class="se">\</span>
  <span class="nt">-v</span> /home/maiminh/PointRCNN.pth:/home/PointRCNN/PointRCNN.pth <span class="se">\</span>
  <span class="nt">-it</span> pointrcnn

<span class="c"># Install pakages and run an example following </span>
<span class="c"># https://github.com/sshaoshuai/PointRCNN</span>
<span class="nb">cd </span>PointRCNN
sh build_and_install.sh
<span class="nb">cd </span>tools
python eval_rcnn.py <span class="nt">--cfg_file</span> cfgs/default.yaml <span class="se">\</span>
  <span class="nt">--ckpt</span> ../PointRCNN.pth <span class="nt">--batch_size</span> 1 <span class="se">\</span>
  <span class="nt">--eval_mode</span> rcnn <span class="nt">--set</span> RPN.LOC_XZ_FINE False
</code></pre></div></div> <h4 id="share-docker-image">Share docker image</h4> <p>Create a account on <a href="https://hub.docker.com/" rel="external nofollow noopener" target="_blank">docker hub</a> and share the above built docker image:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Login with Docker ID (from docker hub)</span>
docker login
<span class="c"># push the image into Docker Hub.</span>
docker tag pointrcnn mnaminh1996/pointrcnn:latest
docker push mnaminh1996/pointrcnn:latest
</code></pre></div></div> <h4 id="run-docker-container">Run docker container</h4> <blockquote> <p>Run docker container on the target machine</p> </blockquote> <p>Pull docker image and run a docker container on the target machine. Similarly, we have to install Docker + NVIDIA Container Toolkit on the target machine, refer <a href="#pre-requirement">Pre-requirement</a>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Pull the docker image from docker hub</span>
docker pull mnaminh1996/pointrcnn:latest
<span class="c"># Run a docker container in interactive mode based on the docker image above</span>
<span class="c"># and blind-mount code, dataset, weight, etc</span>
docker run <span class="nt">--gpus</span> all <span class="nt">-v</span> /home/maiminh1996/PointRCNN/:/home/PointRCNN/ <span class="se">\</span>
  <span class="nt">-v</span> /home/KITTI/data/:/home/PointRCNN/data/ <span class="se">\</span>
  <span class="nt">-v</span> /home/maiminh1996/PointRCNN/PointRCNN.pth:/home/PointRCNN/PointRCNN.pth <span class="se">\</span>
  <span class="nt">-it</span> mnaminh1996/pointrcnn:latest

<span class="c"># Install pakages and run an example following </span>
<span class="c"># https://github.com/sshaoshuai/PointRCNN</span>
<span class="nb">cd </span>PointRCNN
sh build_and_install.sh
<span class="nb">cd </span>tools
python eval_rcnn.py <span class="nt">--cfg_file</span> cfgs/default.yaml <span class="se">\</span>
  <span class="nt">--ckpt</span> ../PointRCNN.pth <span class="nt">--batch_size</span> 1 <span class="se">\</span>
  <span class="nt">--eval_mode</span> rcnn <span class="nt">--set</span> RPN.LOC_XZ_FINE False
</code></pre></div></div> <h3 id="pre-requirement">Pre-requirement</h3> <h4 id="docker">Docker</h4> <p>Install Docker on the host machine and also on the target machine if it is not already installed <a href="https://docs.docker.com/engine/install/" rel="external nofollow noopener" target="_blank">https://docs.docker.com/engine/install/</a>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Update the package index and install the required packages</span>
<span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="se">\</span>
  <span class="nb">sudo </span>apt-get <span class="nb">install </span>apt-transport-https ca-certificates <span class="se">\</span>
  curl gnupg-agent software-properties-common
<span class="c"># Add the GPG key for the Docker repository</span>
curl <span class="nt">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg | <span class="se">\</span>
  <span class="nb">sudo </span>apt-key add -
<span class="c"># Add the Docker repository to ythe system's software stheces</span>
<span class="nb">sudo </span>add-apt-repository <span class="se">\</span>
  <span class="s2">"deb [arch=amd64] https://download.docker.com/linux/ubuntu </span><span class="si">$(</span>lsb_release <span class="nt">-cs</span><span class="si">)</span><span class="s2"> stable"</span>
<span class="c"># Update the package manager's package list and install docker</span>
<span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="se">\</span>
  <span class="nb">sudo </span>apt-get <span class="nb">install </span>docker-ce docker-ce-cli containerd.io
<span class="c"># Verify that Docker is installed correctly by running the following command</span>
<span class="nb">sudo </span>docker run hello-world
</code></pre></div></div> <h4 id="nvidia-container-toolkit">NVIDIA Container Toolkit</h4> <p>Install the NVIDIA Container Toolkit on the host machine <a href="https://github.com/NVIDIA/nvidia-docker" rel="external nofollow noopener" target="_blank">https://github.com/NVIDIA/nvidia-docker</a>. This will allow you to run GPU-accelerated Docker containers.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add the GPG key for the NVIDIA Container Toolkit package repository</span>
curl <span class="nt">-s</span> <span class="nt">-L</span> https://nvidia.github.io/nvidia-docker/gpgkey | <span class="se">\</span>
  <span class="nb">sudo </span>apt-key add -
<span class="c"># Add the package repository to ythe list of stheces</span>
<span class="nv">distribution</span><span class="o">=</span><span class="si">$(</span><span class="nb">.</span> /etc/os-release<span class="p">;</span><span class="nb">echo</span> <span class="nv">$ID$VERSION_ID</span><span class="si">)</span>
curl <span class="nt">-s</span> <span class="nt">-L</span> https://nvidia.github.io/nvidia-docker/<span class="nv">$distribution</span>/nvidia-docker.list | <span class="se">\</span>
  <span class="nb">sudo tee</span> /etc/apt/stheces.list.d/nvidia-docker.list
<span class="c"># Install the `nvidia-docker2` package</span>
<span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="se">\</span>
  <span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> nvidia-docker2
<span class="c"># Restart the Docker daemon</span>
<span class="nb">sudo </span>pkill <span class="nt">-SIGHUP</span> dockerd
</code></pre></div></div> <h3 id="dockerfile">Dockerfile</h3> <p>Some keywords: <code class="language-plaintext highlighter-rouge">FROM</code>, <code class="language-plaintext highlighter-rouge">ENV</code>, <code class="language-plaintext highlighter-rouge">RUN</code>, <code class="language-plaintext highlighter-rouge">WORKDIR</code>, <code class="language-plaintext highlighter-rouge">COPY</code>, <code class="language-plaintext highlighter-rouge">CMD</code>. For the complet list, refer to <a href="https://docs.docker.com/engine/reference/builder/" rel="external nofollow noopener" target="_blank">https://docs.docker.com/engine/reference/builder/</a>.</p> <p>Pre-designed images:</p> <ul> <li><a href="https://hub.docker.com/" rel="external nofollow noopener" target="_blank">https://hub.docker.com/</a></li> <li><a href="https://registry.hub.docker.com/r/nvidia/cuda/tags" rel="external nofollow noopener" target="_blank">https://registry.hub.docker.com/r/nvidia/cuda/tags</a></li> <li><a href="https://hub.docker.com/r/pytorch/pytorch/tags?page=1" rel="external nofollow noopener" target="_blank">https://hub.docker.com/r/pytorch/pytorch/tags?page=1</a></li> </ul> <h3 id="docker-image">Docker image</h3> <blockquote> <p>docker image contains set of cmd and metadata. If Docker image was like a class, docker container is an instance</p> </blockquote> <p>Build a docker image</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build <span class="nt">-t</span> &lt;name-build-image&gt; <span class="nb">.</span> <span class="c"># . where it contains Dockerfile</span>
</code></pre></div></div> <p>List, tag remove images</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Show images</span>
docker images <span class="c"># list all images</span>
<span class="c"># docker image ls</span>

<span class="c"># show the history of an image</span>
docker <span class="nb">history</span> &lt;image-id&gt;

<span class="c"># set image name from image-id</span>
docker tag &lt;image-id&gt; &lt;image-names&gt; 

<span class="c"># remove docker image</span>
<span class="c"># may need to resolve conflict with dependency container </span>
docker rmi &lt;image-id&gt; 
<span class="c"># docker image rm &lt;image-id&gt;</span>
</code></pre></div></div> <h3 id="docker-container">Docker container</h3> <blockquote> <p>each container is an instance of un image.</p> </blockquote> <p>Run a container (it actually creates a new container based on the specified image). We can use VS Code –&gt; Activity bar –&gt; Docker to modify code, manage docker images/ container/ …</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># show all images</span>
docker images

<span class="c"># create a new container</span>
<span class="c"># run a container in interactive mode (-it), built-image: image id/ name</span>
docker run <span class="nt">-it</span> &lt;built-image&gt; 

<span class="c"># list all containers</span>
docker ps <span class="c"># all running containers</span>
<span class="c"># docker ps -a # all containers (including stopped)</span>
</code></pre></div></div> <p>Stop, restart a container</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># stop</span>
docker stop &lt;container-id&gt; 
<span class="c"># docker rm &lt;container-id&gt;</span>

<span class="c"># restart an existing container after it exited and the changes are still there.</span>
docker start &lt;container-id&gt; <span class="c"># restart it in the background</span>
docker attach &lt;container-id&gt; <span class="c"># reattach the terminal &amp; stdin</span>
</code></pre></div></div> <p>Commit a container (intead of working on old container, we can save container changes into new image).</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker commit &lt;container-id&gt; &lt;new-image-name&gt;
</code></pre></div></div> <p>Copy datas from container</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># copy data from a container to local machine</span>
docker <span class="nb">cp</span> &lt;container-id&gt;:app/epoch50.pth /path/
</code></pre></div></div> <p>blind-mount data</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># dataset stored in the /data directory on ythe host machine, </span>
<span class="c"># and you want to mount this directory into a Docker container at /app/data. </span>
docker run <span class="nt">-v</span> /data:/app/data <span class="nt">-it</span> &lt;image_name&gt;
</code></pre></div></div> <h3 id="save-docker-image">Save docker image</h3> <h4 id="save-in-file-tar">Save in file .tar</h4> <p>Save the docker image in <code class="language-plaintext highlighter-rouge">.tar</code>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker save <span class="nt">-o</span> &lt;built-image.tar&gt; &lt;built-image&gt;
</code></pre></div></div> <p>Or export a docker container in <code class="language-plaintext highlighter-rouge">.tar</code>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">export</span> &lt;container-id&gt; <span class="o">&gt;</span> &lt;container-name.tar&gt;
</code></pre></div></div> <h4 id="push-on-docker-hub">Push on docker hub</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker login
docker tag &lt;local-image:tagname&gt; &lt;new-repo:tagname&gt;
docker push &lt;new-repo:tagname&gt;
</code></pre></div></div> <h3 id="references">References</h3> <ol> <li><a href="https://maiminh1996.github.io/distilled/cuda/installing-cuda.html#multi-cuda-version-on-the-one-machine">https://maiminh1996.github.io/distilled/cuda/installing-cuda.html#multi-cuda-version-on-the-one-machine</a></li> <li><a href="https://hub.docker.com/r/mnaminh1996/pointrcnn" rel="external nofollow noopener" target="_blank">https://hub.docker.com/r/mnaminh1996/pointrcnn</a></li> <li><a href="https://registry.hub.docker.com/layers/nvidia/cuda/10.2-cudnn8-devel-ubuntu16.04/images/sha256-f32cdb7cfbd4fb047fe6580333ffd20204fdedc28742fa044885651d5af190f6?context=explore" rel="external nofollow noopener" target="_blank">https://registry.hub.docker.com/layers/nvidia/cuda/10.2-cudnn8-devel-ubuntu16.04/images/sha256-f32cdb7cfbd4fb047fe6580333ffd20204fdedc28742fa044885651d5af190f6?context=explore</a></li> <li><a href="https://github.com/sshaoshuai/PointRCNN.git" rel="external nofollow noopener" target="_blank">https://github.com/sshaoshuai/PointRCNN.git</a></li> <li><a href="https://docs.docker.com/engine/install/" rel="external nofollow noopener" target="_blank">https://docs.docker.com/engine/install/</a></li> <li><a href="https://github.com/NVIDIA/nvidia-docker" rel="external nofollow noopener" target="_blank">https://github.com/NVIDIA/nvidia-docker</a></li> <li><a href="https://docs.docker.com/engine/reference/builder/" rel="external nofollow noopener" target="_blank">https://docs.docker.com/engine/reference/builder/</a></li> <li><a href="https://hub.docker.com/" rel="external nofollow noopener" target="_blank">https://hub.docker.com/</a></li> <li><a href="https://registry.hub.docker.com/r/nvidia/cuda/tags" rel="external nofollow noopener" target="_blank">https://registry.hub.docker.com/r/nvidia/cuda/tags</a></li> <li><a href="https://hub.docker.com/r/pytorch/pytorch/tags?page=1" rel="external nofollow noopener" target="_blank">https://hub.docker.com/r/pytorch/pytorch/tags?page=1</a></li> </ol> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/c-testing-with-gtest/">C++ Testing with GTest</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/tmux/">Tmux: An Introduction to Terminal Multiplexing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/vim/">Basic Vim Usage</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/python-testing-with-pytest/">Python Testing with pytest</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/docker-inside-vs-code/">Docker inside VS Code</a> </li> <div id="disqus_thread" style="max-width: 930px; margin: 0 auto;"> <script type="text/javascript">var disqus_shortname="https-maiminh1996-github-io-5",disqus_identifier="/blog/2022/docker",disqus_title="Docker";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 N. A. Minh MAI. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-repositories",title:"repositories",description:"",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-c-testing-with-gtest",title:"C++ Testing with GTest",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2023/c-testing-with-gtest/"}},{id:"post-tmux-an-introduction-to-terminal-multiplexing",title:"Tmux: An Introduction to Terminal Multiplexing",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2023/tmux/"}},{id:"post-basic-vim-usage",title:"Basic Vim Usage",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2023/vim/"}},{id:"post-python-testing-with-pytest",title:"Python Testing with pytest",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2023/python-testing-with-pytest/"}},{id:"post-docker-inside-vs-code",title:"Docker inside VS Code",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2023/docker-inside-vs-code/"}},{id:"post-expert-advice-for-successful-research",title:"Expert Advice for Successful Research",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/research/"}},{id:"post-good-advice-and-tips",title:"Good advice and tips",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/good-advice-and-tips/"}},{id:"post-docker",title:"Docker",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/docker/"}},{id:"post-loss-function",title:"Loss function",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/loss-function/"}},{id:"post-glossary-ml",title:"Glossary ML",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/glossary/"}},{id:"post-disable-gradient-computation",title:"Disable gradient computation",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/disable-gradient-computation/"}},{id:"post-mastering-google-colab-tips-and-tricks",title:"Mastering Google Colab: Tips and Tricks",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/google-colab/"}},{id:"post-linear-algebra",title:"linear algebra",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/algebra/"}},{id:"post-python-data-structure",title:"Python data structure",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/python-data-structure/"}},{id:"post-math",title:"Math",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/math/"}},{id:"post-git-commit-message",title:"git Commit Message",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/git-commit-message/"}},{id:"post-git-best-pratice",title:"git best pratice",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/git-best-pratice/"}},{id:"post-setting-up-vs-code",title:"Setting up VS Code",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/vscode/"}},{id:"post-git-synthesis",title:"Git Synthesis",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/git/"}},{id:"post-installing-cuda",title:"Installing CUDA",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/installing-cuda/"}},{id:"post-installing-opencv",title:"Installing OpenCV",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/installing-opencv/"}},{id:"post-pihole-camera",title:"Pihole Camera",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2022/pihole-camera/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%6D%61%69%6E%67%75%79%65%6E%61%6E%68%6D%69%6E%68%31%39%39%36@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=lxTC9IIAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/maiminh1996","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/nguyen-anh-minh-mai","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>